import{Z as S,_ as E,$ as x,a0 as R,a1 as I,a2 as W,a3 as m,a4 as _,a5 as v,a6 as D,a7 as h,a8 as G,Y as L,a9 as T,r as w,M as P,aa as z,ab as A,j as s,B as g,J as b,q as C,T as c,L as y,p as j,ac as F,ad as k,ae as B}from"./index-4-NSC4fW.js";import{u as H}from"./useDocumentTitle-DdH0bi9J.js";import{H as J}from"./chunk-7OLJDQMT-CbGc9gFb.js";const M=async()=>{const i=await S(E(x,"users"));let t=[];return i.forEach(n=>{t.push(n.data())}),t},O=()=>{const i=R();return{signInWithGoogle:async()=>{const n=new I,d=await M();W(L,n).then(a=>{var u,f;const e=a.user,r=d.filter(l=>l.user_email===e.email),p=m.AES.decrypt((u=r[0])==null?void 0:u.password,"bu_secret_key").toString(m.enc.Utf8);r&&_(e,p).then(()=>{console.log("password changed")}).catch(l=>{console.log(l)});const o=(f=e.displayName)==null?void 0:f.split(" ");(async()=>await v(e==null?void 0:e.email)?await G(h(x,"users",e==null?void 0:e.email),{provider:"google.com",isEmailVerified:!0}):(await D(h(x,"users",e==null?void 0:e.email),{first_name:o==null?void 0:o[0],last_name:o==null?void 0:o[1],user_email:e==null?void 0:e.email,gender:"",date:Date.now(),provider:"google.com",avatar:"",isEmailVerified:!0}),i({title:"Account succesfully created via Google",status:"success",duration:5e3,isClosable:!0,position:"top"})))()}).catch(a=>{console.log(a.message),a.code==="auth/account-exists-with-different-credential"&&i({title:"Please sign in with Google or using your email adress and password!",status:"error",duration:6e3,isClosable:!0,position:"top"})})}}},U=()=>{const{Login:i}=T(),{authUser:t}=w.useContext(P),n=z(),{signInWithGoogle:d}=O();w.useEffect(()=>{t&&n("/")},[t]);const{register:a,handleSubmit:e}=A(),r=o=>{i({email:o.email,password:o.password})},p=()=>{d()};return s.jsx(g,{id:"sign-in",padding:{base:"0 10px",isLargerThan440:"0 15px"},children:s.jsxs(g,{maxWidth:"400px",margin:"50px auto",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"3px",background:"#53bcf5",children:[s.jsx(J,{fontSize:"1.5rem",color:"#343333",textAlign:"center",as:"h3",children:"Sign in"}),s.jsxs("form",{style:{width:"80%",marginTop:"15px",display:"flex",flexDirection:"column",gap:"10px"},onSubmit:e(r),children:[s.jsx(b,{w:"100%",p:"8px 15px",color:"#343333",type:"email",borderRadius:"5px",border:"none",outline:"none",placeholder:"Email address",_placeholder:{color:"#504c90"},bg:"#e0e6f2",...a("email")}),s.jsx(b,{w:"100%",p:"8px 15px",color:"#343333",type:"password",borderRadius:"5px",border:"none",outline:"none",placeholder:"Password",_placeholder:{color:"#504c90"},bg:"#e0e6f2",...a("password")}),s.jsx(C,{p:"8px 15px",mt:"10px",borderRadius:"5px",border:"none",outline:"none",fontSize:"1rem",type:"submit",bg:"#3d0d6d",color:"#fff",cursor:"pointer",transition:"0.3s linear",fontWeight:"500",_hover:{bg:"#6c4710"},children:"Sign in"})]})," ",s.jsxs(c,{mt:"10px",fontSize:"0.9rem",color:"#343333",children:["Forget your password?"," ",s.jsx(y,{fontWeight:"500",color:"#3217fc",as:j,to:F,children:"Reset now!"})," "]}),s.jsxs(c,{color:"#343333",fontSize:"0.9rem",children:["Don't have account?"," ",s.jsx(y,{fontWeight:"600",color:"#3217fc",as:j,to:k,children:"Register now!"})," "]}),s.jsx(c,{margin:"10px 0",color:"#4e58a0",fontWeight:"700",children:"OR"}),s.jsx(g,{w:"100%",display:"flex",gap:"20px",children:s.jsxs(c,{w:"50%",margin:"0 auto",padding:"2px 5px",fontSize:"0.8rem",color:"#343333",bg:"#dcf4f6",borderRadius:"5px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",onClick:p,children:["Sign in with"," ",s.jsx(B,{size:"1.3rem",style:{marginLeft:"5px"}})]})})]})})};function Y(){return H("Sign in | RoHa"),s.jsx(U,{})}export{Y as default};
